<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Get an Estimate | BinPals Trash Valet</title>
  <meta name="description" content="Request a BinPals Trash Valet estimate. Share your address and how many bins you have and we’ll follow up shortly." />

  <!-- Poppins font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bp-green: #2f855a;
      --bp-green-light: #e6f4ec;
      --bp-green-dark: #22543d;
      --bp-border: #e5e7eb;
      --bp-border-strong: #d1d5db;
      --bp-text: #111827;
      --bp-muted: #4b5563;
      --bp-muted-soft: #9ca3af;
      --bp-error: #b91c1c;
      --bp-radius-lg: 18px;
      --bp-radius-pill: 999px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background-color: #ffffff; /* full page white */
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--bp-text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px 12px;
    }

    .page-wrap {
      width: 100%;
      max-width: 480px;
    }

    .card {
      background-color: #ffffff;
      border-radius: var(--bp-radius-lg);
      border: 1px solid var(--bp-border);
      padding: 20px 18px 22px;
    }

    @media (min-width: 640px) {
      .card {
        padding: 22px 24px 26px;
      }
    }

    .logo-row {
      text-align: center;
      margin-bottom: 6px;
    }

    .logo-row img {
      max-width: 220px;
      height: auto;
    }

    .title {
      text-align: center;
      font-size: 1.6rem;
      font-weight: 700;
      margin: 8px 0 4px;
      letter-spacing: 0.01em;
    }

    .subtitle {
      text-align: center;
      font-size: 0.95rem;
      color: var(--bp-muted);
      margin: 0 0 14px;
    }

    .subtitle strong {
      color: var(--bp-green-dark);
      font-weight: 600;
    }

    /* Progress bar */
    .progress-wrap {
      margin-bottom: 14px;
    }

    .progress-bar-track {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background-color: #f3f4f6;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      width: 0;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--bp-green), var(--bp-green-dark));
      transition: width 200ms ease-out;
    }

    .progress-steps {
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
      font-size: 0.72rem;
      color: var(--bp-muted-soft);
    }

    .step-indicator {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      flex: 1;
    }

    .step-circle {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 1px solid var(--bp-border-strong);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      background-color: #ffffff;
      color: var(--bp-muted-soft);
    }

    .step-label {
      text-align: center;
      white-space: nowrap;
    }

    .step-indicator.active .step-circle {
      border-color: var(--bp-green-dark);
      background-color: var(--bp-green-light);
      color: var(--bp-green-dark);
    }

    .step-indicator.active .step-label {
      color: var(--bp-green-dark);
      font-weight: 600;
    }

    form {
      margin-top: 4px;
    }

    .step-panel {
      display: none;
    }

    .step-panel.active {
      display: block;
    }

    .step-header {
      font-size: 0.92rem;
      font-weight: 600;
      color: var(--bp-green-dark);
      margin-bottom: 6px;
    }

    .step-helper {
      font-size: 0.82rem;
      color: var(--bp-muted);
      margin-bottom: 10px;
    }

    .form-group {
      margin-bottom: 10px;
    }

    .form-label {
      display: block;
      font-size: 0.88rem;
      font-weight: 500;
      margin-bottom: 3px;
      color: var(--bp-text);
    }

    .form-label span {
      color: var(--bp-green-dark);
    }

    .field,
    select.field {
      width: 100%;
      font-size: 0.96rem;
      padding: 10px 12px;
      border-radius: var(--bp-radius-pill);
      border: 1px solid var(--bp-border-strong);
      background-color: #ffffff;
      color: var(--bp-text);
      outline: none;
      transition: border-color 120ms ease-out, background-color 120ms ease-out;
    }

    .field::placeholder {
      color: var(--bp-muted-soft);
    }

    .field:focus {
      border-color: var(--bp-green-dark);
      background-color: var(--bp-green-light);
    }

    select.field {
      appearance: none;
      background-image:
        linear-gradient(45deg, transparent 50%, #6b7280 50%),
        linear-gradient(135deg, #6b7280 50%, transparent 50%);
      background-position:
        calc(100% - 20px) 55%,
        calc(100% - 14px) 55%;
      background-size: 6px 6px, 6px 6px;
      background-repeat: no-repeat;
    }

    .inline-row {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      gap: 8px;
    }

    @media (max-width: 480px) {
      .inline-row {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .nav-row {
      margin-top: 14px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }

    .btn {
      border: none;
      border-radius: var(--bp-radius-pill);
      padding: 10px 14px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: background-color 100ms ease-out, opacity 80ms ease-out, transform 60ms ease-out;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: default;
      transform: none;
    }

    .btn-secondary {
      background-color: #f3f4f6;
      color: var(--bp-muted);
    }

    .btn-secondary:hover:not(:disabled) {
      background-color: #e5e7eb;
      transform: translateY(-1px);
    }

    .btn-primary {
      background-color: var(--bp-green);
      color: #ffffff;
      flex: 1;
      justify-content: center;
    }

    .btn-primary:hover:not(:disabled) {
      background-color: var(--bp-green-dark);
      transform: translateY(-1px);
    }

    /* Submit button shares id submit-btn */
    #submit-btn.loading {
      opacity: 0.85;
      cursor: default;
      transform: none;
    }

    .btn-spinner {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 2px solid rgba(248, 250, 252, 0.5);
      border-top-color: #ffffff;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .message {
      min-height: 20px;
      margin-top: 10px;
      font-size: 0.88rem;
      text-align: center;
    }

    .message.success {
      color: var(--bp-green-dark);
    }

    .message.error {
      color: var(--bp-error);
    }

    .info-text {
      margin-top: 6px;
      font-size: 0.8rem;
      color: var(--bp-muted);
      text-align: center;
    }

    .info-text strong {
      font-weight: 600;
    }
  </style>
</head>
<body>
  <main class="page-wrap">
    <section class="card" aria-labelledby="estimate-title">
      <div class="logo-row">
        <!-- Put this image file in /images/Binpals-Trash-Valet-logo.png in your repo -->
        <img src="images/Binpals-Trash-Valet-logo.png" alt="Binpals Trash Valet logo" />
      </div>

      <h1 id="estimate-title" class="title">Request a BinPals Estimate</h1>
      <p class="subtitle">
        Answer a few quick questions. We’ll review your address and
        <strong>email you with route details and next steps.</strong>
      </p>

      <!-- Progress bar + step labels -->
      <div class="progress-wrap" aria-hidden="true">
        <div class="progress-bar-track">
          <div id="progress-fill" class="progress-bar-fill"></div>
        </div>
        <div class="progress-steps">
          <div class="step-indicator" data-step-label="1">
            <div class="step-circle">1</div>
            <div class="step-label">Your info</div>
          </div>
          <div class="step-indicator" data-step-label="2">
            <div class="step-circle">2</div>
            <div class="step-label">Address</div>
          </div>
          <div class="step-indicator" data-step-label="3">
            <div class="step-circle">3</div>
            <div class="step-label">Bins & plan</div>
          </div>
        </div>
      </div>

      <form id="estimate-form" novalidate>
        <!-- STEP 1 -->
        <div class="step-panel active" data-step="1" aria-labelledby="step1-title">
          <div class="step-header" id="step1-title">Step 1 – Your info</div>
          <div class="step-helper">So we know who to email.</div>

          <div class="form-group">
            <label for="fullName" class="form-label">Full name <span>*</span></label>
            <input
              id="fullName"
              name="entry.104280084"
              class="field"
              type="text"
              autocomplete="name"
              placeholder="First and last name"
              required
            />
          </div>

          <div class="form-group">
            <label for="email" class="form-label">Email address <span>*</span></label>
            <input
              id="email"
              name="entry.417977469"
              class="field"
              type="email"
              autocomplete="email"
              placeholder="you@example.com"
              required
            />
          </div>
        </div>

        <!-- STEP 2 -->
        <div class="step-panel" data-step="2" aria-labelledby="step2-title">
          <div class="step-header" id="step2-title">Step 2 – Your address</div>
          <div class="step-helper">So we can check your route.</div>

          <div class="form-group">
            <label for="street" class="form-label">Street address <span>*</span></label>
            <input
              id="street"
              name="entry.2139416814"
              class="field"
              type="text"
              autocomplete="street-address"
              placeholder="House number and street"
              required
            />
          </div>

          <div class="inline-row">
            <div class="form-group">
              <label for="city" class="form-label">City <span>*</span></label>
              <input
                id="city"
                name="entry.565605156"
                class="field"
                type="text"
                placeholder="City"
                required
              />
            </div>
            <div class="form-group">
              <label for="zip" class="form-label">ZIP code <span>*</span></label>
              <input
                id="zip"
                name="entry.55232557"
                class="field"
                type="text"
                inputmode="numeric"
                pattern="\d{5}"
                placeholder="ZIP"
                required
              />
            </div>
          </div>
        </div>

        <!-- STEP 3 -->
        <div class="step-panel" data-step="3" aria-labelledby="step3-title">
          <div class="step-header" id="step3-title">Step 3 – Bins & plan</div>
          <div class="step-helper">So we can price your service.</div>

          <div class="form-group">
            <label for="bins" class="form-label">How many trash bins? <span>*</span></label>
            <input
              id="bins"
              name="entry.1777532498"
              class="field"
              type="number"
              min="1"
              max="10"
              step="1"
              placeholder="Example: 2"
              required
            />
          </div>

          <div class="form-group">
            <label for="plan" class="form-label">Choose a plan <span>*</span></label>
            <select id="plan" name="entry.707531909" class="field" required>
              <option value="" disabled selected>Tap to pick a plan</option>
              <option value="Premium">Premium – weekly set out & return</option>
              <option value="Premium+">Premium+ – extra flexible service</option>
              <option value="One-Time">One-time vacation / snowbird service</option>
            </select>
          </div>
        </div>

        <!-- Hidden fields -->
        <input type="hidden" name="entry.409104529" value="Pending" />
        <input type="hidden" name="submit" value="Submit" />

        <!-- Navigation buttons -->
        <div class="nav-row">
          <button type="button" id="back-btn" class="btn btn-secondary" disabled>Back</button>

          <!-- This is the real submit button (only used on last step) -->
          <button type="submit" id="submit-btn" class="btn btn-primary">
            <span class="btn-text">Next</span>
          </button>
        </div>

        <p id="form-message" class="message" aria-live="polite"></p>

        <p class="info-text">
          We usually reply within <strong>1–2 business days.</strong><br />
          If you need help, you can also email us at <strong>Binpalsteam@gmail.com</strong>.
        </p>
      </form>
    </section>
  </main>

  <script>
    (function () {
      const FORM_ENDPOINT = "https://docs.google.com/forms/d/e/1FAIpQLSdcKdqxRDDSZKcBA2nPZ3aR1M0uU6TwfYTPLy7unE0xWKKSLQ/formResponse";

      const form = document.getElementById("estimate-form");
      const progressFill = document.getElementById("progress-fill");
      const stepPanels = Array.from(document.querySelectorAll(".step-panel"));
      const stepIndicators = Array.from(document.querySelectorAll(".step-indicator"));
      const backBtn = document.getElementById("back-btn");
      const submitBtn = document.getElementById("submit-btn");
      const formMessage = document.getElementById("form-message");

      const totalSteps = stepPanels.length;
      let currentStep = 1;
      let isSubmitting = false;

      if (!form || !progressFill) return;

      function updateUI() {
        // Show the current panel
        stepPanels.forEach(panel => {
          const step = Number(panel.getAttribute("data-step"));
          panel.classList.toggle("active", step === currentStep);
        });

        // Update step indicators
        stepIndicators.forEach(indicator => {
          const step = Number(indicator.getAttribute("data-step-label"));
          indicator.classList.toggle("active", step === currentStep);
        });

        // Progress bar width
        const progressPercent = (currentStep - 1) / (totalSteps - 1 || 1) * 100;
        progressFill.style.width = progressPercent + "%";

        // Back button
        backBtn.disabled = currentStep === 1 || isSubmitting;

        // Submit button label
        const btnTextSpan = submitBtn.querySelector(".btn-text");
        if (btnTextSpan && !isSubmitting) {
          btnTextSpan.textContent = currentStep === totalSteps ? "Send request" : "Next";
        }
      }

      function showMessage(message, isError) {
        formMessage.textContent = message || "";
        formMessage.classList.remove("success", "error");
        if (!message) return;
        formMessage.classList.add(isError ? "error" : "success");
      }

      function setSubmitting(state) {
        isSubmitting = state;
        submitBtn.classList.toggle("loading", state);
        submitBtn.disabled = state;
        backBtn.disabled = state || currentStep === 1;

        let spinner = submitBtn.querySelector(".btn-spinner");
        const textSpan = submitBtn.querySelector(".btn-text");

        if (state) {
          if (textSpan) textSpan.textContent = "Sending...";
          if (!spinner) {
            spinner = document.createElement("span");
            spinner.className = "btn-spinner";
            submitBtn.insertBefore(spinner, submitBtn.firstChild);
          }
        } else {
          if (spinner) spinner.remove();
          if (textSpan) {
            textSpan.textContent = currentStep === totalSteps ? "Send request" : "Next";
          }
        }
      }

      function validateCurrentStep() {
        // Validate only the inputs in the visible panel
        const panel = stepPanels.find(p => Number(p.getAttribute("data-step")) === currentStep);
        if (!panel) return true;

        const inputs = panel.querySelectorAll("input, select");
        for (const input of inputs) {
          if (!input.checkValidity()) {
            input.reportValidity();
            return false;
          }
        }
        return true;
      }

      backBtn.addEventListener("click", function () {
        if (isSubmitting) return;
        if (currentStep > 1) {
          currentStep -= 1;
          updateUI();
          showMessage("");
        }
      });

      // We hijack submit: if not on last step, just go next
      form.addEventListener("submit", function (event) {
        event.preventDefault();
        showMessage("");

        if (isSubmitting) return;

        if (currentStep < totalSteps) {
          if (!validateCurrentStep()) return;
          currentStep += 1;
          updateUI();
          return;
        }

        // Last step: validate and send
        if (!validateCurrentStep()) return;

        setSubmitting(true);

        const formData = new FormData(form);
        const params = new URLSearchParams();
        for (const [key, value] of formData.entries()) {
          params.append(key, value.toString());
        }

        fetch(FORM_ENDPOINT, {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded"
          },
          body: params.toString()
        })
          .then(function () {
            form.reset();
            currentStep = 1;
            updateUI();
            showMessage(
              "Thanks for requesting a BinPals estimate — we’ll review your address and follow up shortly.",
              false
            );
          })
          .catch(function () {
            showMessage(
              "Something went wrong sending your request. Please try again, or email us at Binpalsteam@gmail.com.",
              true
            );
          })
          .finally(function () {
            setSubmitting(false);
          });
      });

      // Initial UI
      updateUI();
    })();
  </script>
</body>
</html>
